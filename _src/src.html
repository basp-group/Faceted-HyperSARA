<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src package &mdash; Faceted-HyperSARA mnras_real_data-390-g13deaa4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module src.fhs" href="src.fhs.html" />
    <link rel="prev" title="Default parameters" href="../default.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Faceted-HyperSARA
          </a>
              <div class="version">
                mnras_real_data-390-g13deaa4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation &amp; references</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../default.html">Default parameters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">src package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="src.fhs.html">Module src.fhs</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.heuristics.html">Module src.heuristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.hs.html">Module src.hs</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.sara.html">Module src.sara</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-src">API src</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../_lib/lib.html">lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_imaging/imaging.html">imaging package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_pyxisMs2mat/pyxisMs2mat.html">pyxisMs2mat package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Faceted-HyperSARA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>src package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_src/src.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-package">
<h1>src package<a class="headerlink" href="#src-package" title="Permalink to this headline"></a></h1>
<p>Core implementation of the SARA, HyperSARA and Faceted HyperSARA imaging algorithms.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-src" id="id5">API src</a></p></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">List of modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="src.fhs.html">Module src.fhs</a></li>
<li class="toctree-l1"><a class="reference internal" href="src.heuristics.html">Module src.heuristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="src.hs.html">Module src.hs</a></li>
<li class="toctree-l1"><a class="reference internal" href="src.sara.html">Module src.sara</a></li>
</ul>
</div>
<section id="module-src">
<span id="api-src"></span><h2><a class="toc-backref" href="#id5">API src</a><a class="headerlink" href="#module-src" title="Permalink to this headline"></a></h2>
<dl class="mat function">
<dt class="sig sig-object mat" id="src.apply_adjoint_operator">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">apply_adjoint_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">y</span></em>, <em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">Sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.apply_adjoint_operator" title="Permalink to this definition"></a></dt>
<dd><p>Apply part of the adjoint measurment operator (before the scaled
inverse discrete Fourier transform involved in the non-uniform FFT
<span id="id1">[<a class="reference internal" href="../biblio.html#id8" title="Jeffrey A. Fessler and Bradley P. Sutton. Nonuniform fast Fourier transforms using min-max interpolation. IEEE Trans. Signal Process., 51(2):560–574, Januray 2003.">Fessler2003</a>]</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>complex[:]</em>) – Input data array (data-block).</p></li>
<li><p><strong>G</strong> (<em>sparse array</em>) – Gridding matrix (including noise whitening operator).</p></li>
<li><p><strong>Sigma</strong> (<em>double[:]</em>) – Reduction operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Fx</strong> – Gridded visibilities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>complex[:]</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.apply_direct_operator">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">apply_direct_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Fx</span></em>, <em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">Sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.apply_direct_operator" title="Permalink to this definition"></a></dt>
<dd><p>Apply part of the direct measurement operator (after the scaled discrete
Fourier transform involved in the non-uniform FFT <span id="id2">[<a class="reference internal" href="../biblio.html#id8" title="Jeffrey A. Fessler and Bradley P. Sutton. Nonuniform fast Fourier transforms using min-max interpolation. IEEE Trans. Signal Process., 51(2):560–574, Januray 2003.">Fessler2003</a>]</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Fx</strong> (<em>complex[:]</em>) – Scaled discrete Fourier transform of a 2d array <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><strong>G</strong> (<em>complex[:, :]</em>) – Gridding matrix (including noise whitening operator).</p></li>
<li><p><strong>Sigma</strong> (<em>double[:]</em>) – Reduction operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> – Visibility vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>complex[:]</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.apply_scaled_fourier_transform">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">apply_scaled_fourier_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">x</span></em>, <em class="sig-param"><span class="pre">A</span></em>, <em class="sig-param"><span class="pre">No</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.apply_scaled_fourier_transform" title="Permalink to this definition"></a></dt>
<dd><p>Apply scaled Fourier transform to a wideband image cube <span class="math notranslate nohighlight">\(x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double[:, :, :]</em>) – Input wideband image cube.</p></li>
<li><p><strong>A</strong> (<em>lambda function</em>) – Lambda function to compute the scaled Fourier transform of each slice
of the image</p></li>
<li><p><strong>No</strong> (<em>int</em>) – Total number of pixels in the oversampled spatial Fourier plane.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Fx</strong> – Matrix whose column contain the scaled Fourier transform of each
slice of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>double[:, :]</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.compute_residual_images">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">compute_residual_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">x</span></em>, <em class="sig-param"><span class="pre">y</span></em>, <em class="sig-param"><span class="pre">A</span></em>, <em class="sig-param"><span class="pre">At</span></em>, <em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">W</span></em>, <em class="sig-param"><span class="pre">flag_visibility_gridding</span></em>, <em class="sig-param"><span class="pre">Sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.compute_residual_images" title="Permalink to this definition"></a></dt>
<dd><p>Compute residual images.</p>
<p>Compute the residual image for each spectral channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double[:, :, :]</em>) – Wideband image cube <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p></li>
<li><p><strong>y</strong> (<em>cell</em>) – Blocked visibilities <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}</span></code>.</p></li>
<li><p><strong>A</strong> (<em>anonymous function</em>) – Measurement operator <code class="docutils literal notranslate"><span class="pre">&#64;[1]</span></code>.</p></li>
<li><p><strong>At</strong> (<em>anonymous function</em>) – Adjoint measurement operator &#64;[1].</p></li>
<li><p><strong>G</strong> (<em>cell</em>) – Blocked gridding matrix <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}</span></code>.</p></li>
<li><p><strong>W</strong> (<em>cell</em>) – Masking operators (selection of data blocks) <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}</span></code>.</p></li>
<li><p><strong>flag_visibility_gridding</strong> (<em>bool</em>) – Flag to activate data dimensionality reduction via visibility gridding.</p></li>
<li><p><strong>Sigma</strong> (<em>cell</em>) – Dimensionality reduction weights <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>residual_image</strong> (<em>double[:, :, :]</em>) – Residual image cube <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>, normalised by the peak of
the PSF following convention in RI.</p></li>
<li><p><em>————————————————————————-%</em></p></li>
<li><p><strong>Code</strong> (<em>P.-A. Thouvenin.</em>)</p></li>
<li><p><strong>Last revised</strong> (<em>[08/08/2019]</em>)</p></li>
<li><p><em>————————————————————————-%</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.compute_sara_prior">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">compute_sara_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">x</span></em>, <em class="sig-param"><span class="pre">Psit</span></em>, <em class="sig-param"><span class="pre">n_wavelet_coefficients</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.compute_sara_prior" title="Permalink to this definition"></a></dt>
<dd><p>Compute the l21-norm of the wavelet cofficients associated with the SARA
dictionary.</p>
<p>Compute <span class="math notranslate nohighlight">\(\Vert \boldsymbol{\Psi}^\dagger \mathbf{X} \Vert_{2,1}\)</span> for
an input wideband image <span class="math notranslate nohighlight">\(\mathbf{X} \in \mathbb{R}^{N\times L}\)</span>,
with <span class="math notranslate nohighlight">\(\boldsymbol{\Psi}^\dagger\)</span> the SARA dictionary
<span id="id3">[<a class="reference internal" href="../biblio.html#id4" title="R. E. Carrillo, J. D. McEwen, and Y. Wiaux. Sparsity averaging reweighted analysis (SARA): a novel algorithm for radio-interferometric imaging. Monthly Notices of the Royal Astronomical Society, 426(2):1223–1234, 2012.">Carrillo2012</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double[:, :, :]</em>) – Wideband image cube <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p></li>
<li><p><strong>Psit</strong> (<em>anonymous function</em>) – SARA dictionary <code class="docutils literal notranslate"><span class="pre">&#64;[1]</span></code>.</p></li>
<li><p><strong>n_wavelet_coefficients</strong> (<em>int</em>) – Number of wavelet coefficients (per channel) <code class="docutils literal notranslate"><span class="pre">[1]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f</strong> – Value of
<span class="math notranslate nohighlight">\(\Vert \boldsymbol{\Psi}^\dagger \mathbf{X} \Vert_{2,1}\)</span>,
with <span class="math notranslate nohighlight">\(\boldsymbol{\Psi}^\dagger\)</span> the SARA dictionary
<span id="id4">[<a class="reference internal" href="../biblio.html#id4" title="R. E. Carrillo, J. D. McEwen, and Y. Wiaux. Sparsity averaging reweighted analysis (SARA): a novel algorithm for radio-interferometric imaging. Monthly Notices of the Royal Astronomical Society, 426(2):1223–1234, 2012.">Carrillo2012</a>]</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.nuclear_norm">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">nuclear_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.nuclear_norm" title="Permalink to this definition"></a></dt>
<dd><p>Compute the nuclear norm of a wideband image.</p>
<p>Compute <span class="math notranslate nohighlight">\(\Vert \mathbf{X} \Vert_*\)</span> for <span class="math notranslate nohighlight">\(\mathbf{X} \in
\mathbb{R}^{N \times L}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>double[:, :, :]</em>) – Wideband image cube <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f</strong> – Nuclear norm of the wideband image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.proj_l2ball">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">proj_l2ball</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">x</span></em>, <em class="sig-param"><span class="pre">eps</span></em>, <em class="sig-param"><span class="pre">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.proj_l2ball" title="Permalink to this definition"></a></dt>
<dd><p>Compute the projection of the input vector <span class="math notranslate nohighlight">\(x\)</span> onto the
<span class="math notranslate nohighlight">\(\ell_2\)</span> ball centered in <span class="math notranslate nohighlight">\(y\)</span> with radius <span class="math notranslate nohighlight">\(\varepsilon\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Input vector.</p></li>
<li><p><strong>eps</strong> (<em>double</em>) – Radius of the <span class="math notranslate nohighlight">\(\ell_2\)</span> ball.</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Center of the <span class="math notranslate nohighlight">\(\ell_2\)</span> ball.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.sanity_check">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">epsilon</span></em>, <em class="sig-param"><span class="pre">norm_res</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.sanity_check" title="Permalink to this definition"></a></dt>
<dd><p>Update the data fidelity term in the preconditioned primal-dual algorithm.</p>
<p>Update the data fidelity terms owned by each worked involved in the group
of data nodes (with preconditioning -&gt; projection onto an ellipsoid).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epsilon</strong> (<em>cell</em>) – Norm of the residual <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[1]</span></code>.</p></li>
<li><p><strong>norm_res</strong> (<em>cell</em>) – <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball constraints <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[1]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>global_norm_res</strong> (<em>double</em>) – Square global norm of the residual.</p></li>
<li><p><strong>norm_epsilon</strong> (<em>double</em>) – Square global norm of epsilon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.update_dual_data_fidelity">
<span class="sig-prename descclassname"><span class="pre">src.</span></span><span class="sig-name descname"><span class="pre">update_dual_data_fidelity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">v2</span></em>, <em class="sig-param"><span class="pre">y</span></em>, <em class="sig-param"><span class="pre">x</span></em>, <em class="sig-param"><span class="pre">Fx_old</span></em>, <em class="sig-param"><span class="pre">proj</span></em>, <em class="sig-param"><span class="pre">A</span></em>, <em class="sig-param"><span class="pre">At</span></em>, <em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">W</span></em>, <em class="sig-param"><span class="pre">pU</span></em>, <em class="sig-param"><span class="pre">epsilon</span></em>, <em class="sig-param"><span class="pre">elipse_proj_max_iter</span></em>, <em class="sig-param"><span class="pre">elipse_proj_min_iter</span></em>, <em class="sig-param"><span class="pre">elipse_proj_eps</span></em>, <em class="sig-param"><span class="pre">sigma22</span></em>, <em class="sig-param"><span class="pre">flag_dimensionality_reduction</span></em>, <em class="sig-param"><span class="pre">Sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.update_dual_data_fidelity" title="Permalink to this definition"></a></dt>
<dd><p>Update the data fidelity term in the preconditioned primal-dual algorithm.</p>
<p>Update the data fidelity terms owned by each worked involved in the group
of data nodes (with preconditioning <span class="math notranslate nohighlight">\(\rightarrow\)</span> projection onto
an ellipsoid).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v2</strong> (<em>cell</em>) – Data fidelity dual variable <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[M,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>y</strong> (<em>cell</em>) – Blocks of visibilities <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[M,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>x</strong> (<em>double[:, :, :]</em>) – Primal variable <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p></li>
<li><p><strong>Fx_old</strong> (<em>complex[:, :, :]</em>) – Scaled Fourier transform of <span class="math notranslate nohighlight">\(x\)</span> from the previous iterations
<code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p></li>
<li><p><strong>proj</strong> (<em>cell</em>) – Value of the projection at the previous global iteration, taken as a
starting point <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[M,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>A</strong> (<em>anonymous function</em>) – Measurement operator &#64;[1].</p></li>
<li><p><strong>At</strong> (<em>anonymous function</em>) – Adjoint measurement operator &#64;[1].</p></li>
<li><p><strong>G</strong> (<em>cell</em>) – Blocked interpolation matrix {L}{nblocks}.</p></li>
<li><p><strong>W</strong> (<em>cell</em>) – Blocked masking operator {L}{nblocks}.</p></li>
<li><p><strong>pU</strong> (<em>cell</em>) – Preconditioning matrices {L}{nblocks}.</p></li>
<li><p><strong>epsilon</strong> (<em>cell</em>) – <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball constraints {L}{nblocks}[1].</p></li>
<li><p><strong>elipse_proj_max_iter</strong> (<em>int</em>) – Maximum number of iterations (projection onto the ellipsoid)</p></li>
<li><p><strong>elipse_proj_min_iter</strong> (<em>int</em>) – Minimum number of iterations (projection onto the ellipsoid)</p></li>
<li><p><strong>elipse_proj_eps</strong> (<em>double</em>) – Stopping criterion for the projection.</p></li>
<li><p><strong>sigma22</strong> (<em>double[:]</em>) – Step-size for the update of the dual variable (tau*sigma2).</p></li>
<li><p><strong>flag_dimensionality_reduction</strong> (<em>bool</em>) – Flag to activate DR functionality.</p></li>
<li><p><strong>Sigma</strong> (<em>cell</em>) – Dimensionality reduction weights {L}{nblocks}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>v2</strong> (<em>cell</em>) – Data fidelity dual variable <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[M,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>Ftx</strong> (<em>double[:, :]</em>) – Auxiliary variable for the update of the primal variable <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2)]</span></code>.</p></li>
<li><p><em>Fx_old</em> – Scaled Fourier transform of the updated image <code class="docutils literal notranslate"><span class="pre">[N(1),</span> <span class="pre">N(2),</span> <span class="pre">L]</span></code>.</p></li>
<li><p><strong>proj</strong> (<em>cell</em>) – Result of the projection step  <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[M,</span> <span class="pre">1]</span></code>.</p></li>
<li><p><strong>norm_res</strong> (<em>cell</em>) – Norm of the residual <code class="docutils literal notranslate"><span class="pre">{L}{nblocks}[1]</span></code>.</p></li>
<li><p><strong>global_norm_res</strong> (<em>double</em>) – Square global norm of the residual.</p></li>
<li><p><strong>norm_epsilon</strong> (<em>double</em>) – Square global norm of epsilon.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../default.html" class="btn btn-neutral float-left" title="Default parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="src.fhs.html" class="btn btn-neutral float-right" title="Module src.fhs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, P.-A. Thouvenin, A. Dabbech, M. Jiang, A. Jackson, Y. Wiaux, A. Abdulaziz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>